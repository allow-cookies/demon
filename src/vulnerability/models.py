from django.db.models import PROTECT, CharField, ForeignKey, TextField
from django.utils.translation import gettext_lazy as _

from dependency.models import Dependency
from shared.models import UUIDModel


class Vulnerability(UUIDModel):
    class Fields(UUIDModel.Fields):
        DEPENDENCY = "dependency"
        VERSION_RANGE = "version_range"
        DESCRIPTION = "description"

    class Meta:
        verbose_name_plural = _("Vulnerabilities")

    dependency = ForeignKey(Dependency, on_delete=PROTECT)
    version_range = CharField(max_length=255)
    description = TextField(default="")
